<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Hello World</title>
	<script
	src="https://code.jquery.com/jquery-3.3.1.js"
	integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
	crossorigin="anonymous"></script>
</head>
<body>
	<div class="calc_deposit1">
		<div>
			<input type="text" id="input" placeholder="총 보험료">
		</div>
		<input type="text" id="output" placeholder="입금액" readonly>
    </div>
    <div class="calc_deposit2">
        <div>
            <input type="text" id="input" placeholder="총 보험료">
        </div>
        <input type="text" id="output" placeholder="입금액" readonly>
    </div>
</body>
<script async>
var AmountCalculator = (function () {
    function AmountCalculator(wrapperSelector, inputSelector, outputSelector, event, divisor) {
        // public(공개속성)
        this.divisor = divisor;

        // private(은닉속성)
        var _event = event;
        var _inputEle = $(wrapperSelector + " " + inputSelector);
        var _outputEle = $(wrapperSelector + " " + outputSelector);

        // 이하 모두 private(은닉메소드)

        var _renderAomunt = function() {
            var amount = getAomunt(_inputEle.val(), this.divisor)
            _outputEle.val(amount);
        }.bind(this);

        var _$init = function() {
            _inputEle.on(_event, function() {
                _renderAomunt();
            })
        }

        _$init(); // 가독성을 위해서 함수로 분리했어요
    }

    // private(은닉메소드) - prototype 처럼 한 번만 생성된다 - 독립적인 블랙박스 함수!
    function getAomunt(totalAmunt, divisor) {
        if("string" === typeof totalAmunt) { totalAmunt = Number.parseInt(totalAmunt); }
        if(!Number.isInteger(totalAmunt)) { return 0; }

        var Aomunt = totalAmunt / divisor;
        return Math.floor(Aomunt / 10) * 10; // 10원 단위 절사
    }

    return AmountCalculator;
}());

var amountCalculator1 = new AmountCalculator(".calc_deposit1", "#input", "#output", "keyup", 2);
var amountCalculator2 = new AmountCalculator(".calc_deposit2", "#input", "#output", "keyup", 2);

/*
	//리팩토링 전

	calcDeposit();
	function calcDeposit() {
		var calc =  $('.btn_calc');

		calc.click( function() {
			var input = $('#input_enter').val();
			var output = input/2;

			if( output % 2 ) {
				output = (Math.floor(output * 0.1)) * 10;
			}

			$('#output').val(output);
		})
	}

	//객체지향으로 리팩토링 후

	calcDeposit();
	//입력값을 나누기 2 했을 시에 끝 자리가 5로 끝나면 내림이 되어서 나와야함. example )(50(input) / 2) = 25 -> 20(최종아웃풋)
	function calcDeposit() {
         var calc =  $('.btn_calc'); // 입력버튼

         var calc_output = function(input) {
         	var output = input/2;

         	if( output % 2 ) {
         		output = (Math.floor(output * 0.1)) * 10;
         	}

         	return output;
         };

         var put_output = function() {
         	var input = $('#input_enter').val(); 
         	$('#output').val(calc_output(input));
         };

         calc.click(function() {
         	put_output();
         });
     }
*/
 </script>
 </html>